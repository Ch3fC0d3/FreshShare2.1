<%- contentFor('style') %>
<style>
    .group-details {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .group-header {
        display: flex;
        align-items: center;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .group-info {
        flex: 1;
        min-width: 300px;
    }

    .group-actions {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 10px;
    }

    .group-section {
        background: #fff;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
    }

    .members-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
        gap: 15px;
        margin-top: 15px;
    }

    .member-card {
        text-align: center;
        padding: 10px;
        border: 1px solid #eee;
        border-radius: 8px;
        transition: all 0.2s ease;
    }
    
    .member-card:hover {
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .member-avatar {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        margin-bottom: 8px;
        object-fit: cover;
    }
    
    .member-role {
        display: inline-block;
        padding: 2px 6px;
        border-radius: 4px;
        font-size: 0.8rem;
        margin-top: 5px;
    }
    
    .role-admin {
        background-color: #ffd700;
        color: #333;
    }
    
    .role-member {
        background-color: #e6f7ff;
        color: #0066cc;
    }

    .events-list {
        display: grid;
        gap: 15px;
    }

    .event-card {
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 15px;
        transition: all 0.2s ease;
    }
    
    .event-card:hover {
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    
    .event-actions {
        margin-top: 10px;
        display: flex;
        gap: 10px;
    }

    .discussion-board {
        max-height: 400px;
        overflow-y: auto;
        border: 1px solid #eee;
        border-radius: 8px;
        padding: 10px;
        margin-bottom: 15px;
    }

    .message {
        padding: 12px;
        margin-bottom: 12px;
        border-radius: 8px;
        background-color: #f8f9fa;
    }
    
    .message-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
    }
    
    .message-content {
        white-space: pre-wrap;
    }

    .shopping-list table {
        width: 100%;
        border-collapse: collapse;
    }

    .shopping-list th, .shopping-list td {
        padding: 10px;
        text-align: left;
        border-bottom: 1px solid #eee;
    }
    
    .shopping-list-actions {
        width: 100px;
    }
    
    .add-item-form {
        margin-top: 20px;
        padding-top: 20px;
        border-top: 1px solid #eee;
    }
    
    .form-row {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 15px;
    }
    
    .form-group {
        flex: 1;
        min-width: 150px;
    }
    
    .badge-category {
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.8rem;
        margin-right: 10px;
    }
    
    .category-neighborhood {
        background-color: #e6f7ff;
        color: #0066cc;
    }
    
    .category-community_garden {
        background-color: #f6ffed;
        color: #52c41a;
    }
    
    .category-food_bank {
        background-color: #fff7e6;
        color: #fa8c16;
    }
    
    .category-cooking_club {
        background-color: #fff0f6;
        color: #eb2f96;
    }
    
    .category-other {
        background-color: #f9f0ff;
        color: #722ed1;
    }
    
    .loading-spinner {
        display: inline-block;
        width: 1rem;
        height: 1rem;
        border: 2px solid rgba(0, 0, 0, 0.1);
        border-left-color: #09f;
        border-radius: 50%;
        animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
        to { transform: rotate(360deg); }
    }
    
    .status-badge {
        display: inline-block;
        padding: 3px 6px;
        border-radius: 4px;
        font-size: 0.75rem;
        font-weight: 500;
    }
    
    .status-active {
        background-color: #d4edda;
        color: #155724;
    }
    
    .status-pending {
        background-color: #fff3cd;
        color: #856404;
    }
</style>

<%- contentFor('body') %>
<div class="group-details">
    <!-- Group Header Section -->
    <div class="group-header group-section">
        <div class="group-info">
            <h1 id="group-name"></h1>
            <div class="mb-2">
                <span id="group-category-badge" class="badge-category"></span>
                <span class="status-badge status-active">Active</span>
            </div>
            <p id="group-description"></p>
            <div class="group-meta mt-3">
                <div><i class="fas fa-users"></i> <span id="member-count"></span> members</div>
                <div><i class="fas fa-map-marker-alt"></i> <span id="group-location"></span></div>
                <div><i class="fas fa-calendar"></i> Delivery days: <span id="delivery-days"></span></div>
            </div>
        </div>
        <div class="group-actions">
            <button class="btn btn-primary" id="join-group-btn">Join Group</button>
            <button class="btn btn-outline-primary" id="leave-group-btn" style="display: none;">Leave Group</button>
            <button class="btn btn-outline-secondary" id="share-group-btn"><i class="fas fa-share-alt"></i> Share</button>
            <div id="admin-actions" style="display: none;">
                <button class="btn btn-outline-primary" id="edit-group-btn"><i class="fas fa-edit"></i> Edit Group</button>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-8">
            <!-- Shopping List Section -->
            <div class="group-section shopping-list">
                <div class="section-header">
                    <h3>Shopping List</h3>
                    <button class="btn btn-sm btn-primary" id="add-item-toggle"><i class="fas fa-plus"></i> Add Item</button>
                </div>
                
                <!-- Add Item Form (initially hidden) -->
                <div class="add-item-form" id="add-item-form" style="display: none;">
                    <h5>Add New Item</h5>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="product-name">Product Name</label>
                            <input type="text" class="form-control" id="product-name" placeholder="Enter product name">
                        </div>
                        <div class="form-group">
                            <label for="vendor">Vendor</label>
                            <input type="text" class="form-control" id="vendor" placeholder="Enter vendor name">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="case-price">Case Price ($)</label>
                            <input type="number" step="0.01" min="0" class="form-control" id="case-price" placeholder="0.00">
                        </div>
                        <div class="form-group">
                            <label for="quantity">Quantity</label>
                            <input type="number" min="1" class="form-control" id="quantity" placeholder="1">
                        </div>
                        <div class="form-group">
                            <label for="total-units">Total Units</label>
                            <input type="number" min="1" class="form-control" id="total-units" placeholder="1">
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="notes">Notes</label>
                            <textarea class="form-control" id="item-notes" placeholder="Any additional information about this item"></textarea>
                        </div>
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-primary" id="save-item-btn">Add to Shopping List</button>
                        <button type="button" class="btn btn-outline-secondary ml-2" id="cancel-item-btn">Cancel</button>
                    </div>
                </div>
                
                <!-- Shopping List Table -->
                <div class="table-responsive mt-3">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Vendor</th>
                                <th>Case Price</th>
                                <th>Quantity</th>
                                <th>Total Units</th>
                                <th class="shopping-list-actions">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="shopping-list-body">
                            <!-- Shopping list items will be added here -->
                        </tbody>
                    </table>
                </div>
                <div id="empty-shopping-list" class="text-center py-4" style="display: none;">
                    <p class="text-muted">No items in the shopping list yet.</p>
                </div>
            </div>

            <!-- Discussion Board Section -->
            <div class="group-section">
                <div class="section-header">
                    <h3>Discussion Board</h3>
                </div>
                <div class="discussion-board" id="discussion-board">
                    <!-- Messages will be added here -->
                </div>
                <div id="empty-discussion" class="text-center py-4" style="display: none;">
                    <p class="text-muted">No messages yet. Start the conversation!</p>
                </div>
                <div class="mt-3">
                    <textarea class="form-control" id="message-input" placeholder="Write a message..."></textarea>
                    <div class="d-flex justify-content-end mt-2">
                        <button class="btn btn-primary" id="send-message-btn">Send Message</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <!-- Events Section -->
            <div class="group-section">
                <div class="section-header">
                    <h3>Upcoming Events</h3>
                    <button class="btn btn-sm btn-primary" id="create-event-btn"><i class="fas fa-plus"></i> Create Event</button>
                </div>
                <div class="events-list" id="events-list">
                    <!-- Events will be added here -->
                </div>
                <div id="empty-events" class="text-center py-4" style="display: none;">
                    <p class="text-muted">No upcoming events.</p>
                </div>
                
                <!-- Create Event Form (initially hidden) -->
                <div id="create-event-form" class="mt-3" style="display: none;">
                    <h5>Create New Event</h5>
                    <div class="form-group">
                        <label for="event-title">Event Title</label>
                        <input type="text" class="form-control" id="event-title" placeholder="Enter event title">
                    </div>
                    <div class="form-group">
                        <label for="event-date">Date & Time</label>
                        <input type="datetime-local" class="form-control" id="event-date">
                    </div>
                    <div class="form-group">
                        <label for="event-location">Location</label>
                        <input type="text" class="form-control" id="event-location" placeholder="Enter location">
                    </div>
                    <div class="form-group">
                        <label for="event-description">Description</label>
                        <textarea class="form-control" id="event-description" placeholder="Describe the event"></textarea>
                    </div>
                    <div class="mt-3">
                        <button type="button" class="btn btn-primary" id="save-event-btn">Create Event</button>
                        <button type="button" class="btn btn-outline-secondary ml-2" id="cancel-event-btn">Cancel</button>
                    </div>
                </div>
            </div>

            <!-- Members Section -->
            <div class="group-section">
                <div class="section-header">
                    <h3>Members</h3>
                    <button class="btn btn-sm btn-outline-primary" id="invite-member-btn"><i class="fas fa-user-plus"></i> Invite</button>
                </div>
                <div class="members-grid" id="members-grid">
                    <!-- Members will be added here -->
                </div>
                <div id="empty-members" class="text-center py-4" style="display: none;">
                    <p class="text-muted">No members yet.</p>
                </div>
            </div>
            
            <!-- Group Rules Section -->
            <div class="group-section">
                <h3>Group Rules</h3>
                <div id="group-rules">
                    <!-- Rules will be added here -->
                </div>
                <div id="empty-rules" class="text-center py-4" style="display: none;">
                    <p class="text-muted">No rules have been set for this group.</p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Status Messages -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" style="z-index: 5">
        <div id="status-toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto" id="toast-title">Notification</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toast-message">
                <!-- Toast message will be added here -->
            </div>
        </div>
    </div>
</div>

<%- contentFor('script') %>
<script src="/js/group-details.js"></script>
